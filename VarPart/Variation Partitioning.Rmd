---
title: "Variation Partitioning"
author: "Rodolfo Pelinson"
date: "07/04/2021"
output: github_document
editor_options: 
  chunk_output_type: console
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


First we have to load the separated data matrices we need. It all comes from the Data.csv file in the Data folder. The data matrices are prepared sourcing the "Loading_data.R" file in the Auxiliary Scripts folder.
```{r, echo=TRUE, eval=FALSE}
source("Loading_data.R")
```


```{r, echo=FALSE, eval=TRUE, message=FALSE, warning=FALSE}
source("C:/Users/rodol/OneDrive/Trabalho/Papers/Analysis/AtlanticForestMetacommunity/Auxiliary Scripts/Loading_data.R")
library(AtlanticForestMetacommunity)
```

The used packages to run this analysis are:

`vegan` version 2.5-6   
`ade4` version 1.7-15   
`adespatial` version 0.3-8   

```{r, echo=FALSE, eval=TRUE, message=FALSE, warning=FALSE}
library(vegan)
library(ade4)
library(adespatial)
```
\  
\  
\  
\  

## Reducing Multicolinearity

To remove multicolinear variables from our Environmental Matrix I built a function that removes variables with the variance inflation factor (VIF) higher than 3. The function `VIF_selection()` simply uses the `vif.cca()` from the `vegan` package. 
```{r}
Broad_env_VIF <- VIF_selection(Broad_pa,  Broad_env_st[,-6])

SSF_env_VIF <- VIF_selection(SSF_pa,  SSF_env_st)
ST_env_VIF <- VIF_selection(ST_pa,  ST_env_st)
IC_env_VIF <- VIF_selection(IC_pa,  IC_env_st)
NI_env_VIF <- VIF_selection(NI_pa,  NI_env_st)
MD_env_VIF <- VIF_selection(MD_pa,  MD_env_st)
JA_env_VIF <- VIF_selection(JA_pa,  JA_env_st)

DRF_env_VIF <- VIF_selection(DRF_pa,  DRF_env_st)
UBA_env_VIF <- VIF_selection(UBA_pa,  UBA_env_st)
BER_env_VIF <- VIF_selection(BER_pa,  BER_env_st)
ITA_env_VIF <- VIF_selection(ITA_pa,  ITA_env_st)
```
\  
\  


Same thing for climate variables
```{r}
Broad_clim_VIF <- VIF_selection(Broad_pa,  Broad_clim_st[,-6])
SSF_clim_VIF <- VIF_selection(SSF_pa,  SSF_clim_st)
DRF_clim_VIF <- VIF_selection(DRF_pa,  DRF_clim_st)
```
\  
\  

## Spatial Variables

Constructing matrices of spatial filters
```{r}
Broad_dbMEM <- dbmem(dist(Broad_coord), silent = F, thresh = NULL)

SSF_dbMEM <- dbmem(dist(SSF_coord), silent = F, thresh = NULL)
ST_dbMEM <- dbmem(dist(ST_coord), silent = F, thresh = NULL)
IC_dbMEM <- dbmem(dist(IC_coord), silent = F, thresh = NULL)
NI_dbMEM <- dbmem(dist(NI_coord), silent = F, thresh = NULL)
MD_dbMEM <- dbmem(dist(MD_coord), silent = F, thresh = NULL)
JA_dbMEM <- dbmem(dist(JA_coord), silent = F, thresh = NULL)

DRF_dbMEM <- dbmem(dist(DRF_coord), silent = F, thresh = NULL)
UBA_dbMEM <- dbmem(dist(UBA_coord), silent = F, thresh = NULL)
BER_dbMEM <- dbmem(dist(BER_coord), silent = F, thresh = NULL)
ITA_dbMEM <- dbmem(dist(ITA_coord), silent = F, thresh = NULL)

```
\  
\  
\  
\  


## Forward Selection

Similarly to removing variables with VIF higher than 3, I built a function to select the most important variables, when they could significantly explain species occurrences. This function mostly rely on the function `fs()` from package `adespatial`. Forward selection is only performed when the whole predictor matrix can significantly explain (p < 0.05) the variation in species occurrences.


### Broad Spatial Extent
```{r, cache = TRUE, warning=FALSE}
Broad_env_FS <- forward_selection(Broad_pa, Broad_env_VIF)
Broad_clim_FS <- forward_selection(Broad_pa, Broad_clim_VIF)
Broad_dbMEM_FS <- forward_selection(Broad_pa, Broad_dbMEM)

#Retained Environmental Variables
colnames(Broad_env_FS)

#Retained Climate Variables
colnames(Broad_clim_FS)

#Retained Spatial Variables
colnames(Broad_dbMEM_FS)
```
\  
\  

### Intermediate Spatial Extent
#### DRF
```{r, cache = TRUE, warning=FALSE}
DRF_env_FS <- forward_selection(DRF_pa, DRF_env_VIF)
DRF_clim_FS <- forward_selection(DRF_pa, DRF_clim_VIF)
DRF_dbMEM_FS <- forward_selection(DRF_pa, DRF_dbMEM)

#Retained Environmental Variables
colnames(DRF_env_FS)

#Retained Climate Variables
colnames(DRF_clim_FS)

#Retained Spatial Variables
colnames(DRF_dbMEM_FS)

```
\  
\ 

#### SSF
```{r, cache = TRUE, warning=FALSE}
SSF_env_FS <- forward_selection(SSF_pa, SSF_env_VIF)
SSF_clim_FS <- forward_selection(SSF_pa, SSF_clim_VIF)
SSF_dbMEM_FS <- forward_selection(SSF_pa, SSF_dbMEM)

#Retained Environmental Variables
colnames(SSF_env_FS)

#Retained Climate Variables
colnames(SSF_clim_FS)

#Retained Spatial Variables
colnames(SSF_dbMEM_FS)

```
\  
\  

### Small Spatial Extent
#### DRF
Ubatuba
```{r, cache = TRUE, warning=FALSE}
UBA_env_FS <- forward_selection(UBA_pa, UBA_env_VIF)
UBA_dbMEM_FS <- forward_selection(UBA_pa, UBA_dbMEM)

#Retained Environmental Variables
colnames(UBA_env_FS)

#Retained Spatial Variables
colnames(UBA_dbMEM_FS)

```
\  
\  

Bertioga
```{r, cache = TRUE, warning=FALSE}
BER_env_FS <- forward_selection(BER_pa, BER_env_VIF)
BER_dbMEM_FS <- forward_selection(BER_pa, BER_dbMEM)

#Retained Environmental Variables
colnames(BER_env_FS)

#Retained Spatial Variables
colnames(BER_dbMEM_FS)

```
\  
\  

Itanhaém
```{r, cache = TRUE, warning=FALSE}
ITA_env_FS <- forward_selection(ITA_pa, ITA_env_VIF)
ITA_dbMEM_FS <- forward_selection(ITA_pa, ITA_dbMEM)

#Retained Environmental Variables
colnames(ITA_env_FS)

#Retained Spatial Variables
colnames(ITA_dbMEM_FS)

```
\  
\  

#### SSF
Santa Fé do Sul
```{r, cache = TRUE, warning=FALSE}
ST_env_FS <- forward_selection(ST_pa, ST_env_VIF)
ST_dbMEM_FS <- forward_selection(ST_pa, ST_dbMEM)

#Retained Environmental Variables
colnames(ST_env_FS)

#Retained Spatial Variables
colnames(ST_dbMEM_FS)

```
\  
\  

Icém
```{r, cache = TRUE, warning=FALSE}
IC_env_FS <- forward_selection(IC_pa, IC_env_VIF)
IC_dbMEM_FS <- forward_selection(IC_pa, IC_dbMEM)

#Retained Environmental Variables
colnames(IC_env_FS)

#Retained Spatial Variables
colnames(IC_dbMEM_FS)

```
\  
\  

Nova Itapirema
```{r, cache = TRUE, warning=FALSE}
NI_env_FS <- forward_selection(NI_pa, NI_env_VIF)
NI_dbMEM_FS <- forward_selection(NI_pa, NI_dbMEM)

#Retained Environmental Variables
colnames(NI_env_FS)

#Retained Spatial Variables
colnames(NI_dbMEM_FS)

```
\  
\  

Morro do Diabo
```{r, cache = TRUE, warning=FALSE}
MD_env_FS <- forward_selection(MD_pa, MD_env_VIF)
MD_dbMEM_FS <- forward_selection(MD_pa, MD_dbMEM)

#Retained Environmental Variables
colnames(MD_env_FS)

#Retained Spatial Variables
colnames(MD_dbMEM_FS)

```
\  
\  

Jataí
```{r, cache = TRUE, warning=FALSE}
JA_env_FS <- forward_selection(JA_pa, JA_env_VIF)
JA_dbMEM_FS <- forward_selection(JA_pa, JA_dbMEM)

#Retained Environmental Variables
colnames(JA_env_FS)

#Retained Spatial Variables
colnames(JA_dbMEM_FS)

```
\  
\  
\  
\  



We can plot the important spatial variables to better understand what spatial patterns they describe.

Large Scale MEM 1, 2, 3 and 4.
```{r, fig.height= 10, fig.width=10, fig.align='center'}
par(mfrow = c(2,2))
sr_value(Broad_coord, Broad_dbMEM_FS[,1], ylim = c(-24.49270,-20.17833), xlim = c(-52.64536, -44.51492), grid=F, csize = 0.8, clegend = 1.5, xax = 2, yax = 1, method = "bubble")
title(main = "LARGE SCALE MEM 1", line = 3, outer = F, adj = 1)

sr_value(Broad_coord, Broad_dbMEM_FS[,2], ylim = c(-24.49270,-20.17833), xlim = c(-52.64536, -44.51492), grid=F, csize = 0.8, clegend = 1.5, xax = 2, yax = 1, method = "bubble")
title(main = "LARGE SCALE MEM 2", line = 3, outer = F, adj = 1)

sr_value(Broad_coord, Broad_dbMEM_FS[,3], ylim = c(-24.49270,-20.17833), xlim = c(-52.64536, -44.51492), grid=F, csize = 0.8, clegend = 1.5, xax = 2, yax = 1, method = "bubble")
title(main = "LARGE SCALE MEM 3", line = 3, outer = F, adj = 1)

sr_value(Broad_coord, Broad_dbMEM_FS[,4], ylim = c(-24.49270,-20.17833), xlim = c(-52.64536, -44.51492), grid=F, csize = 0.8, clegend = 1.5, xax = 2, yax = 1, method = "bubble")
title(main = "LARGE SCALE MEM 4", line = 3, outer = F, adj = 1)

```

\  
\  
\  
\  



Intermediate Scale DRF MEM 1.
```{r, fig.height= 5, fig.width=5, fig.align='center'}
par(mfrow = c(1,1))
sr_value(DRF_coord, DRF_dbMEM_FS[,1], ylim = c(-24.59270,-23.33123), xlim = c(-47.61181, -44.61492), grid=F, csize = 0.8, clegend = 1.5, xax = 2, yax = 1, method = "bubble")
title(main = "DRF MEM 1", line = 3, outer = F, adj = 1)

```

\  
\  
\  
\  



Intermediate Scale SSF MEM 1.
```{r, fig.height= 5, fig.width=5, fig.align='center'}
sr_value(SSF_coord, SSF_dbMEM_FS[,1], ylim = c(-22.61958,-20.17833), xlim = c(-52.54536, -47.52589), grid=F, csize = 0.8, clegend = 1.5, xax = 2, yax = 1, method = "bubble")
title(main = "SSF MEM 1", line = 3, outer = F, adj = 1)

```

\  
\  
\  
\  


Small Extent DRF - Ubatuba MEM 1
```{r, fig.height= 5, fig.width=5, fig.align='center'}
sr_value(UBA_coord, UBA_dbMEM_FS[,1], ylim = c(-23.37694,-23.33123), xlim = c(-44.95004, -44.80492), grid=F, csize = 0.8, clegend = 1.5, xax = 2, yax = 1, method = "bubble")
title(main = "Ubatuba MEM 1", line = 3, outer = F, adj = 1)


```

\  
\  


Small Extent DRF - Bertioga MEM 1
```{r, fig.height= 5, fig.width=5, fig.align='center'}
sr_value(BER_coord, BER_dbMEM_FS[,1], ylim = c(-23.76198,-23.71684), xlim = c(-45.94223, -45.73709), grid=F, csize = 0.8, clegend = 1.5, xax = 2, yax = 1, method = "bubble")
title(main = "Bertioga MEM 1", line = 3, outer = F, adj = 1)

```

\  
\  
\  
\  


Small Extent DRF - Itanhaém MEM 1 and 2.
```{r, fig.height= 5, fig.width=10, fig.align='center'}
par(mfrow = c(1,2))

sr_value(ITA_coord, ITA_dbMEM_FS[,1], ylim = c(-24.6527,-24.1786), xlim = c(-47.31181, -46.89443), grid=F, csize = 0.8, clegend = 1.5, xax = 2, yax = 1, method = "bubble")
title(main = "Itanhaém MEM 1", line = 3, outer = F, adj = 1)


sr_value(ITA_coord, ITA_dbMEM_FS[,2], ylim = c(-24.6527,-24.1786), xlim = c(-47.31181, -46.89443), grid=F, csize = 0.8, clegend = 1.5, xax = 2, yax = 1, method = "bubble")
title(main = "Itanhaém MEM 2", line = 3, outer = F, adj = 1)

```

\  
\  
\  
\  



Small Extent DRF - Santa Fé do Sul MEM 1 and 2.
```{r, fig.height= 5, fig.width=10, fig.align='center'}
par(mfrow = c(1,2))

sr_value(ST_coord, ST_dbMEM_FS[,1], ylim = c(-20.18789,-20.17733), xlim = c(-50.89639, -50.89056), grid=F, csize = 0.8, clegend = 1.5, xax = 2, yax = 1, method = "bubble")
title(main = "Santa Fé do Sul MEM 1", line = 3, outer = F, adj = 1)


sr_value(ST_coord, ST_dbMEM_FS[,2], ylim = c(-20.18789,-20.17733), xlim = c(-50.89639, -50.89056), grid=F, csize = 0.8, clegend = 1.5, xax = 2, yax = 1, method = "bubble")
title(main = "Santa Fé do Sul MEM 2", line = 3, outer = F, adj = 1)

```

\  
\  
\  
\  



Small Extent DRF - Icém MEM 1 and 2.
```{r, fig.height= 5, fig.width=10, fig.align='center'}
par(mfrow = c(1,2))

sr_value(IC_coord, IC_dbMEM_FS[,1], ylim = c(-20.375,-20.355), xlim = c(-49.28556, -49.18333), grid=F, csize = 0.8, clegend = 1.5, xax = 2, yax = 1, method = "bubble")
title(main = "Icém MEM 1", line = 3, outer = F, adj = 1)


sr_value(IC_coord, IC_dbMEM_FS[,2], ylim = c(-20.375,-20.355), xlim = c(-49.28556, -49.18333), grid=F, csize = 0.8, clegend = 1.5, xax = 2, yax = 1, method = "bubble")
title(main = "Icém MEM 2", line = 3, outer = F, adj = 1)

```

\  
\  
\  
\  





Small Extent DRF - Nova Itapirema MEM 1.
```{r, fig.height= 5, fig.width=5, fig.align='center'}
sr_value(NI_coord, NI_dbMEM_FS[,1], ylim = c(-21.08111,-21.07333), xlim = c(-49.54072, -49.51689), grid=F, csize = 0.8, clegend = 1.5, xax = 2, yax = 1, method = "bubble")
title(main = "Nova Itapirema MEM 1", line = 3, outer = F, adj = 1)

```

\  
\  
\  
\  




Small Extent DRF - Morro do Diabo MEM 1.
```{r, fig.height= 5, fig.width=5, fig.align='center'}
sr_value(MD_coord, MD_dbMEM_FS[,1], ylim = c(-22.65958, -22.34950), xlim = c(-52.34536, -52.16550), grid=F, csize = 0.8, clegend = 1.5, xax = 2, yax = 1, method = "bubble")
title(main = "Morro do Diabo MEM 1", line = 3, outer = F, adj = 1)

```

\  
\  
\  
\  



Small Extent DRF - Jataí MEM 1.
```{r, fig.height= 5, fig.width=5, fig.align='center'}
sr_value(JA_coord, JA_dbMEM_FS[,1], ylim = c(-21.58556, -21.56376), xlim = c(-47.79086, -47.72289), grid=F, csize = 0.8, clegend = 1.5, xax = 2, yax = 1, method = "bubble")
title(main = "Jataí MEM 1", line = 3, outer = F, adj = 1)

```

\  
\  
\  
\  


## Variation Partitioning
 
 

#### Large Extent
```{r, cache = TRUE}
#Variation partitioning Broad
Broad_varpart <- var_partitioning_1(Y = Broad_pa, 
                                       env = Broad_env_FS,
                                       clim = Broad_clim_FS,
                                       spa = Broad_dbMEM_FS, percent_r2 = F)
Broad_varpart
```
\  
\  
 
#### Intermediate Extent
```{r, cache = TRUE}
DRF_varpart <- var_partitioning_1(Y = DRF_pa, 
                                      env = DRF_env_FS,
                                      clim = DRF_clim_FS,
                                      spa = DRF_dbMEM_FS, percent_r2 = F)

SSF_varpart <- var_partitioning_1(Y = SSF_pa, 
                                      env = SSF_env_FS,
                                      clim = SSF_clim_FS,
                                      spa = SSF_dbMEM_FS, percent_r2 = F)

SSF_varpart
DRF_varpart
```
\  
\  
 
#### Small Extent

Small Extent allowing negative fractions
```{r, cache = TRUE}
ST_varpart <- var_partitioning_2(ST_pa, ST_env_FS, ST_dbMEM_FS, allow_negative_r2 = T, percent_r2 = F)
IC_varpart <- var_partitioning_2(IC_pa, IC_env_FS, IC_dbMEM_FS, allow_negative_r2 = T, percent_r2 = F)
NI_varpart <- var_partitioning_2(NI_pa, NI_env_FS, NI_dbMEM_FS, allow_negative_r2 = T, percent_r2 = F)
MD_varpart <- var_partitioning_2(MD_pa, MD_env_FS, MD_dbMEM_FS, allow_negative_r2 = T, percent_r2 = F)
JA_varpart <- var_partitioning_2(JA_pa, JA_env_FS, JA_dbMEM_FS, allow_negative_r2 = T, percent_r2 = F)

UBA_varpart <- var_partitioning_2(UBA_pa, UBA_env_FS, UBA_dbMEM_FS, allow_negative_r2 = T, percent_r2 = F)
BER_varpart <- var_partitioning_2(BER_pa, BER_env_FS, BER_dbMEM_FS, allow_negative_r2 = T, percent_r2 = F)
ITA_varpart <- var_partitioning_2(ITA_pa, ITA_env_FS, ITA_dbMEM_FS, allow_negative_r2 = T, percent_r2 = F)

ST_varpart
IC_varpart
NI_varpart
MD_varpart
JA_varpart

UBA_varpart
BER_varpart
ITA_varpart
```
\  
\  
  
  

Small Extent not allowing negative fractions
```{r, cache = TRUE}
ST_varpart2 <- var_partitioning_2(ST_pa, ST_env_FS, ST_dbMEM_FS, allow_negative_r2 = F, percent_r2 = F)
IC_varpart2 <- var_partitioning_2(IC_pa, IC_env_FS, IC_dbMEM_FS, allow_negative_r2 = F, percent_r2 = F)
NI_varpart2 <- var_partitioning_2(NI_pa, NI_env_FS, NI_dbMEM_FS, allow_negative_r2 = F, percent_r2 = F)
MD_varpart2 <- var_partitioning_2(MD_pa, MD_env_FS, MD_dbMEM_FS, allow_negative_r2 = F, percent_r2 = F)
JA_varpart2 <- var_partitioning_2(JA_pa, JA_env_FS, JA_dbMEM_FS, allow_negative_r2 = F, percent_r2 = F)

UBA_varpart2 <- var_partitioning_2(UBA_pa, UBA_env_FS, UBA_dbMEM_FS, allow_negative_r2 = F, percent_r2 = F)
BER_varpart2 <- var_partitioning_2(BER_pa, BER_env_FS, BER_dbMEM_FS, allow_negative_r2 = F, percent_r2 = F)
ITA_varpart2 <- var_partitioning_2(ITA_pa, ITA_env_FS, ITA_dbMEM_FS, allow_negative_r2 = F, percent_r2 = F)

ST_varpart2
IC_varpart2
NI_varpart2
MD_varpart2
JA_varpart2

UBA_varpart2
BER_varpart2
ITA_varpart2
```
\  
\  

Constructing a matrix with all R2 values 
```{r, message=FALSE, warning=FALSE}
library(dplyr)

Varpart_plot <- full_join(data.frame(rbind(Broad_varpart[,1])),
                          data.frame(rbind(SSF_varpart[,1])),)

Varpart_plot <- full_join(Varpart_plot,
                          data.frame(rbind(DRF_varpart[,1])))

Varpart_plot <- full_join(Varpart_plot,
                          data.frame(rbind(ST_varpart2[,1])))

Varpart_plot <- full_join(Varpart_plot,
                          data.frame(rbind(IC_varpart2[,1])))

Varpart_plot <- full_join(Varpart_plot,
                          data.frame(rbind(NI_varpart2[,1])))

Varpart_plot <- full_join(Varpart_plot,
                          data.frame(rbind(MD_varpart2[,1])))

Varpart_plot <- full_join(Varpart_plot,
                          data.frame(rbind(JA_varpart2[,1])))
                          
Varpart_plot <- full_join(Varpart_plot,
                          data.frame(rbind(UBA_varpart2[,1])))

Varpart_plot <- full_join(Varpart_plot,
                          data.frame(rbind(BER_varpart2[,1])))

Varpart_plot <- full_join(Varpart_plot,
                          data.frame(rbind(ITA_varpart2[,1])))

rownames(Varpart_plot) <- c("Broad", "SSF", "DRF", "Santa Fé do Sul", "Icém", "Nova Itapirema", "Morro do Diabo", "Jataí", "Ubatuba", "Bertioga", "Itanhaém")

Varpart_barplot <- t(Varpart_plot)
Varpart_barplot
```
\  
\    
\  
\      
  

Plotting the Variation Partioning as barplots.
```{r, fig.height= 10, fig.width=10, fig.align='center'}
library(plotrix)

Varpart_barplot <- Varpart_barplot[-c(1:4),]


for(i in 1:dim(Varpart_barplot)[1]){
  for(j in 1:dim(Varpart_barplot)[2]){
    if(is.na(Varpart_barplot[i,j])){Varpart_barplot[i,j] <- 0}
  }
}


Varpart_barplot_break <- Varpart_barplot; Varpart_barplot_break[8,] <- Varpart_barplot_break[8,]-0.3

Varpart_barplot_break <- Varpart_barplot_break[c(1,4,3,6,2,5,7,8),]

barplot(as.matrix(Varpart_barplot_break), axes = F, col = c(Pure_Env = "gold",
                                                            Env_Spa = mix_color(alpha = 0.4,"gold","cornflowerblue"),
                                                            Pure_Spa = "cornflowerblue",
                                                            Spa_Clim  = mix_color(alpha = 0.4,"brown1","cornflowerblue"),
                                                            Pure_Clim = "brown1",
                                                            Env_Clim  = mix_color(alpha = 0.4,"brown1","gold"),
                                                            Spa_Clim_Env = mix_color(alpha = 0.7,"brown1","grey"),
                                                            Resid = "grey80"), space = c(0,2,1,2,1,1,1,1,2,1,1), border = "white",
        legend.text = c("Environment","Environment-Space","Space","Climate-Space","Climate","Climate-Environment","All three","Residual"), ylim = c(0,0.8),
        args.legend	= list(x = -0.5,y = 0.85, yjust = 1,xjust = 0, horiz = F, ncol = 4, box.col = "transparent",text.width = 5, border = "white"), axisnames= F, ylab = "Adjusted R²", cex.lab = 1.25)
axis(2, at = c(0,0.1,0.2,0.3,0.4,0.5,0.6, 0.7), labels = c("0 %","10 %","20 %","30 %","40 %","50 %","60 %","100 %"))
axis.break(2, 0.65, style = "slash") 
axis(1,at = c(0.5,4.5,16),line = 2, labels =c("Broad","Intermediate","Fine"), tick = F,las = 1, hadj = 0.5, cex.axis = 1.3)
axis(1,at = c(12.5,21.5),line = 0.5, labels =c("SSF","DRF"), tick = F,las = 1, hadj = 0.5, cex.axis = 1.1)
text(c(0.5,   3.5,5.5   ,8.5,10.5,12.5,14.5,16.5,    19.5,21.5,23.5),rep(0.69,11), labels =c("All","SSF","DRF","Santa Fé do Sul","Icém","Nova Itapirema","Morro do Diabo","Jataí","Ubatuba","Bertioga","Itanhaém"), srt = 90, adj = 1, col = "grey45")
text(c(8.5,14.5,16.5,21.5,23.5),c(0.045,0.07,0.54,0.01,0.05), labels =c("*","*","*","*","*"), adj = 0.5, col = "white", cex = 2)
text(c(0.5,0.5,0.5),c(0.02,0.07,0.205), labels =c("*","*","*"), adj = 0.5, col = "white", cex = 2)
text(c(3.5,3.5,5.5),c(0.04,0.155,0.035), labels =c("*","*","*"), adj = 0.5, col = "white", cex = 2)

```
The asterisks represent significant fractions.
